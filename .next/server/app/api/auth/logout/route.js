(()=>{var e={};e.id=489,e.ids=[489],e.modules={6330:e=>{"use strict";e.exports=require("@prisma/client")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5511:e=>{"use strict";e.exports=require("crypto")},7598:e=>{"use strict";e.exports=require("node:crypto")},6962:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>x,routeModule:()=>l,serverHooks:()=>h,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>w});var s={};r.r(s),r.d(s,{POST:()=>p});var a=r(2706),n=r(8203),i=r(5994),u=r(9187),o=r(6702),d=r(8122);async function p(){let e=await (0,o.Nx)();return e&&(await (0,o.T$)(e.sessionId),await (0,d.Q)({userId:e.userId,eventType:"logout"})),await (0,o.C0)(),u.NextResponse.json({ok:!0})}let l=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/auth/logout/route",pathname:"/api/auth/logout",filename:"route",bundlePath:"app/api/auth/logout/route"},resolvedPagePath:"C:\\Users\\mlodg\\Downloads\\HUD\\hud-webapp\\src\\app\\api\\auth\\logout\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:c,workUnitAsyncStorage:w,serverHooks:h}=l;function x(){return(0,i.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:w})}},6487:()=>{},8335:()=>{},8122:(e,t,r)=>{"use strict";r.d(t,{Q:()=>n});var s=r(7914),a=r(4512);async function n(e){let t=await (0,a.b3)(),r=e.ip??t.get("x-forwarded-for")??t.get("x-real-ip")??null,n=e.userAgent??t.get("user-agent")??null;await s.z.authEvent.create({data:{userId:e.userId??null,usernameAttempted:e.usernameAttempted??null,eventType:e.eventType,ip:r,userAgent:n}})}},7914:(e,t,r)=>{"use strict";r.d(t,{z:()=>a});var s=r(6330);let a=globalThis.prisma??new s.PrismaClient},6702:(e,t,r)=>{"use strict";r.d(t,{$G:()=>l,C0:()=>c,Nx:()=>p,T$:()=>w,V_:()=>h,jw:()=>d});var s=r(4512),a=r(5511),n=r(7914),i=r(5378);let u="hud_session";function o(e){return(0,a.createHash)("sha256").update(e).digest("hex")}async function d(e){let t=(0,i.Ak)(32),r=o(t),s=new Date(Date.now()+6048e5);return await n.z.session.create({data:{userId:e,tokenHash:r,expiresAt:s}}),t}async function p(){let e=(await (0,s.UL)()).get(u);if(!e?.value)return null;let t=o(e.value),r=await n.z.session.findUnique({where:{tokenHash:t},include:{user:!0}});return!r||r.expiresAt<new Date||r.user.disabled?(r&&await n.z.session.delete({where:{id:r.id}}).catch(()=>{}),null):(await n.z.session.update({where:{id:r.id},data:{lastSeenAt:new Date}}),{userId:r.userId,sessionId:r.id})}async function l(e){(await (0,s.UL)()).set(u,e,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800,path:"/"})}async function c(){(await (0,s.UL)()).delete(u)}async function w(e){await n.z.session.delete({where:{id:e}}).catch(()=>{})}async function h(e){await n.z.session.deleteMany({where:{userId:e}})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[989,71,44],()=>r(6962));module.exports=s})();