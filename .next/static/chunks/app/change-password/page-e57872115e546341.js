(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[143],{7933:(e,s,a)=>{Promise.resolve().then(a.bind(a,4424))},6046:(e,s,a)=>{"use strict";var r=a(6658);a.o(r,"useRouter")&&a.d(s,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(s,{useSearchParams:function(){return r.useSearchParams}})},4424:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>o});var r=a(5155),t=a(2115),n=a(6046);function l(){let e=(0,n.useRouter)(),s=(0,n.useSearchParams)().get("from")||"/hud",[a,l]=(0,t.useState)(""),[o,d]=(0,t.useState)(""),[c,u]=(0,t.useState)(""),[i,h]=(0,t.useState)(""),[m,p]=(0,t.useState)(!1),[x,f]=(0,t.useState)(!0);async function b(r){if(r.preventDefault(),h(""),o!==c){h("New passwords do not match");return}if(o.length<8){h("Password must be at least 8 characters");return}p(!0);try{let r=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:a,newPassword:o})}),t=await r.json().catch(()=>({}));if(!r.ok){h(t.error||"Failed to change password"),p(!1);return}e.push(s),e.refresh()}catch(e){h("Network error")}finally{p(!1)}}return((0,t.useEffect)(()=>{fetch("/api/auth/me").then(s=>(s.ok||e.replace("/login?from="+encodeURIComponent("/change-password")),s.json())).then(a=>{a&&!a.mustChangePassword&&e.replace(s)}).catch(()=>e.replace("/login")).finally(()=>f(!1))},[s,e]),x)?(0,r.jsx)("main",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("p",{children:"Loading…"})}):(0,r.jsx)("main",{className:"min-h-screen flex items-center justify-center p-4 bg-gray-100",children:(0,r.jsxs)("div",{className:"w-full max-w-sm bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h1",{className:"text-xl font-bold mb-4",children:"Change password"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"You must change your password before continuing."}),(0,r.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[i&&(0,r.jsx)("p",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:i}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current password"}),(0,r.jsx)("input",{type:"password",value:a,onChange:e=>l(e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New password"}),(0,r.jsx)("input",{type:"password",value:o,onChange:e=>d(e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",required:!0,minLength:8})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm new password"}),(0,r.jsx)("input",{type:"password",value:c,onChange:e=>u(e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",required:!0,minLength:8})]}),(0,r.jsx)("button",{type:"submit",disabled:m,className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:m?"Updating…":"Update password"})]})]})})}function o(){return(0,r.jsx)(t.Suspense,{fallback:(0,r.jsx)("main",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("p",{children:"Loading…"})}),children:(0,r.jsx)(l,{})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[441,517,358],()=>s(7933)),_N_E=e.O()}]);